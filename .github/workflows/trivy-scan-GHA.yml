name: Trivy scan via GHA

on:
    push:
     branches:
      - main
    workflow_dispatch:

permissions:
    id-token: write
    contents: read

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - name: Compile Code
        run: echo "Compiling..."

      - name: Produce Binary
        run: sleep 5

      - name: Push binary
        run: echo "Pushing Binary to ECR..."

      - name: Check out repository code
        uses: actions/checkout@v3

      - name: Trivy scan
        uses: cloudbees-io-gha/trivy-scan-publish@v2
        with:
          binary-tar-path: ./golang-alpine.tar
          # cloudbees-pat: ${{ secrets.CLOUDBEES_PAT }}
          
          
         
